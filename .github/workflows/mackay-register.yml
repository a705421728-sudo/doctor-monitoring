name: é¦¬å•å…’ç«¥é†«é™¢æ›è™Ÿç›£æ§

on:
  schedule:
    # æ¯15åˆ†é˜åŸ·è¡Œä¸€æ¬¡ï¼ˆé…åˆå…§éƒ¨3è¼ªé‡è©¦ï¼‰
    - cron: '*/15 * * * *'
  workflow_dispatch:  # å…è¨±æ‰‹å‹•è§¸ç™¼

jobs:
  mackay-register:
    runs-on: ubuntu-latest
    
    steps:
    - name: æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v3
    
    - name: è¨­ç½® Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: å®‰è£ä¾è³´
      run: |
        python -m pip install --upgrade pip
        pip install requests beautifulsoup4
    
    - name: åŸ·è¡Œæ›è™Ÿç›£æ§
      env:
        MACKAY_ID_NUMBER: ${{ secrets.MACKAY_ID_NUMBER }}
        MACKAY_BIRTHDAY: ${{ secrets.MACKAY_BIRTHDAY }}
        MACKAY_NOTIFICATION_EMAIL: ${{ secrets.MACKAY_NOTIFICATION_EMAIL }}
        SMTP_SERVER: ${{ secrets.SMTP_SERVER }}
        SMTP_PORT: ${{ secrets.SMTP_PORT }}
        SMTP_USERNAME: ${{ secrets.SMTP_USERNAME }}
        SMTP_PASSWORD: ${{ secrets.SMTP_PASSWORD }}
        SMTP_SENDER: ${{ secrets.SMTP_SENDER }}
        GITHUB_ACTIONS: 'true'
      run: |
        echo "ğŸ¥ é¦¬å•æ›è™Ÿç›£æ§å•Ÿå‹•"
        echo "åŸ·è¡Œæ™‚é–“: $(date)"
        echo "äº‹ä»¶è§¸ç™¼: ${{ github.event_name }}"
        python mackay_registrar.py
        echo "åŸ·è¡Œå®Œæˆ"
